import{s as U}from"./index-Cn_iqxZv.js";import{a as k,s as C}from"./index-BZdkZB22.js";import{s as Q}from"./index-CE414EAY.js";import{g as R,u as E,ac as B,r as i,c as D,_ as I,z as O,b as m,d as p,f as o,e,F as P,x as S,t as f,s as T,l as _}from"./index-BWWByROH.js";import{_ as q}from"./BreadcrumbList.vue_vue_type_script_setup_true_lang-CZdJiYSg.js";import{D as A}from"./DiscussionThread-BzX03X7A.js";import"./index-DJe2vpyj.js";import"./index-2Hpez_V6.js";import"./index-C0HwIFuv.js";import"./index-CLY3q3Oj.js";const $=R({name:"EditBCR",components:{DiscussionThread:A},setup(){const a=E(),s=B(),V=i(s.params.requestNo||""),v=i("Jakson"),g=i("29/9/2025"),w=i([{label:"Exceed Budget",value:"Exceed Budget"},{label:"Mockup Remeasurement",value:"Mockup Remeasurement"},{label:"QS remeasurement",value:"QS remeasurement"},{label:"VO",value:"VO"},{label:"Others",value:"Others"}]),c=i([{label:"STL-01",value:"STL-01",description:"Steel reinforcement bar 60mm",uom:"Ton"},{label:"CEM-02",value:"CEM-02",description:"Cement Portland Type I",uom:"Bag"},{label:"TIL-03",value:"TIL-03",description:"Ceramic floor tiles 600x600mm",uom:"m²"},{label:"MAR-04",value:"MAR-04",description:"Premium marble slab",uom:"m²"}]),u=i([{role:"Site",name:"John Smith",datetime:"08/09/2024, 23:30:00",message:"Current tiles are adequate for the purpose. Upgrade not essential from operational perspective.",documentUrl:"https://example.com/doc1.pdf",isEditing:!1},{role:"PM",name:"Jane Doe",datetime:"09/09/2024, 19:20:00",message:"Cost increase is too significant without clear functional benefit. Budget constraints do not allow this upgrade.",isEditing:!1}]),n=i([{itemCode:"TIL-03",description:"Ceramic floor tiles 600x600mm",uom:"m²",unitPrice:165,budgetQty:250,orderedQty:0,newOrder:250,exceededQty:0,exceededPercent:0,estimatedExceed:41250,varianceQty:0,varianceAmount:34875,remark:"Upgrade to premium marble for enhanced aesthetic appeal",notes:"",showNotes:!1,showRemark:!1},{itemCode:"STL-01",description:"Steel reinforcement bar 60mm",uom:"Ton",unitPrice:500,budgetQty:10,orderedQty:10,newOrder:12,exceededQty:2,exceededPercent:20,estimatedExceed:1e3,varianceQty:2,varianceAmount:1e3,remark:"",notes:"Urgent requirement",showNotes:!1,showRemark:!1},{itemCode:"CEM-02",description:"Cement Portland Type I",uom:"Bag",unitPrice:12,budgetQty:200,orderedQty:200,newOrder:250,exceededQty:50,exceededPercent:25,estimatedExceed:600,varianceQty:50,varianceAmount:600,remark:"For foundation work",notes:"",showNotes:!1,showRemark:!1}]),y=()=>{n.value.push({itemCode:"",description:"",uom:"",unitPrice:0,budgetQty:0,orderedQty:0,newOrder:0,exceededQty:0,exceededPercent:0,estimatedExceed:0,varianceQty:0,varianceAmount:0,notes:"",remark:"",showNotes:!1,showRemark:!1})},x=d=>{const t=c.value.find(h=>h.value===d.itemCode);t&&(d.description=t.description,d.uom=t.uom)},r=d=>{const t=c.value.find(h=>h.value===d);return t?t.label:d},b=D(()=>n.value.reduce((d,t)=>d+(t.varianceAmount||0),0)),l=i(!0);return{roNumber:V,requestBy:v,requestDate:g,reasonOptions:w,items:n,addItem:y,itemOptions:c,fillItemDetails:x,getItemLabel:r,totalVarianceAmount:b,isAttachmentValid:l,goBack:()=>a.push({name:"bcr"}),discussionData:u,active:i("0")}}}),N={class:"p-6 card"},L={class:"flex items-center justify-between mb-6"},M={class:"flex gap-2"},F={class:"card p-4 mb-6 shadow"},j={class:"grid grid-cols-2 gap-4 text-sm"},J={class:"card p-4 mb-6 shadow"},z={class:"flex items-center justify-between mb-4"},H={class:"overflow-x-auto"},K={class:"min-w-full rounded-lg border"},G={class:"px-3 py-2"},W={class:"flex flex-col"},X={class:"font-medium"},Y={class:"text-xs text-gray-500"},Z={key:0},ee={key:1,class:"text-gray-400"},te={class:"px-3 py-2"},le={class:"px-3 py-2"},se={class:"px-3 py-2"},oe={class:"px-3 py-2"},ae={class:"px-3 py-2"},de={class:"px-3 py-2"},ne={class:"px-3 py-2"},re={class:"px-3 py-2"},ie={class:"px-3 py-2"},ue={class:"px-3 py-2"},ce={class:"px-3 py-2 text-center"},me={class:"text-right mt-4 font-semibold"};function pe(a,s,V,v,g,w){const c=q,u=T,n=Q,y=k,x=C,r=U,b=O("DiscussionThread");return m(),p("div",N,[o(c),e("div",L,[s[4]||(s[4]=e("div",null,[e("h1",{class:"text-2xl font-bold"},"Edit Budget Change Request"),e("p",{class:"text-gray-500"},"Project: MKT")],-1)),e("div",M,[o(u,{label:"Cancel",onClick:s[0]||(s[0]=l=>a.$router.push("/bcr")),outlined:""}),o(u,{label:"Save as Draft",severity:"secondary",outlined:""}),o(u,{label:"Submit Request",disabled:!a.isAttachmentValid},null,8,["disabled"])])]),e("div",F,[s[9]||(s[9]=e("h3",{class:"text-lg font-semibold mb-4"},"Header Information",-1)),e("div",j,[e("div",null,[s[5]||(s[5]=e("label",{class:"block text-gray-600 mb-1"},"Request No",-1)),o(n,{modelValue:a.roNumber,"onUpdate:modelValue":s[1]||(s[1]=l=>a.roNumber=l),type:"text",class:"w-full text-sm"},null,8,["modelValue"])]),e("div",null,[s[6]||(s[6]=e("label",{class:"block text-gray-600 mb-1"},"Requested By",-1)),o(n,{modelValue:a.requestBy,"onUpdate:modelValue":s[2]||(s[2]=l=>a.requestBy=l),type:"text",class:"w-full text-sm"},null,8,["modelValue"])]),e("div",null,[s[7]||(s[7]=e("label",{class:"block text-gray-600 mb-1"},"Date Requested",-1)),o(n,{modelValue:a.requestDate,"onUpdate:modelValue":s[3]||(s[3]=l=>a.requestDate=l),type:"text",class:"w-full text-sm"},null,8,["modelValue"])]),e("div",null,[s[8]||(s[8]=e("label",{class:"block text-gray-600 mb-1"},"Reason of Request",-1)),o(y,{options:a.reasonOptions,optionLabel:"label",optionValue:"value",placeholder:"Select Reason",class:"w-full text-sm"},null,8,["options"])])])]),e("div",J,[e("div",z,[s[10]||(s[10]=e("h3",{class:"text-lg font-semibold"},"Materials",-1)),o(u,{label:"Add Item",icon:"pi pi-plus",onClick:a.addItem,outlined:""},null,8,["onClick"])]),e("div",H,[e("table",K,[s[11]||(s[11]=e("thead",{class:"text-sm text-gray-600 bg-gray-50"},[e("tr",null,[e("th",{class:"px-3 py-2 text-left"},"Item Code"),e("th",{class:"px-3 py-2 text-left"},"Description"),e("th",{class:"px-3 py-2 text-left"},"Units"),e("th",{class:"px-3 py-2 text-left"},"Unit Price"),e("th",{class:"px-3 py-2 text-left"},"Budgeted Quantity"),e("th",{class:"px-3 py-2 text-left"},"Ordered Quantity"),e("th",{class:"px-3 py-2 text-left"},"New Order"),e("th",{class:"px-3 py-2 text-left"},"Exceeded Quantity"),e("th",{class:"px-3 py-2 text-left"},"Exceeded %"),e("th",{class:"px-3 py-2 text-left"},"Estimated $ exceed"),e("th",{class:"px-3 py-2 text-left"},"Remarks"),e("th",{class:"px-3 py-2 text-left"},"Actions")])],-1)),e("tbody",null,[(m(!0),p(P,null,S(a.items,(l,d)=>(m(),p("tr",{key:d,class:"border-t align-top"},[e("td",G,[o(x,{modelValue:l.itemCode,"onUpdate:modelValue":t=>l.itemCode=t,options:a.itemOptions,optionLabel:"label",optionValue:"value",placeholder:"Select item...",class:"w-full",onChange:t=>a.fillItemDetails(l)},{option:_(t=>[e("div",W,[e("span",X,f(t.option.label),1),e("span",Y,f(t.option.description),1)])]),value:_(t=>[t.value?(m(),p("span",Z,f(a.getItemLabel(t.value)),1)):(m(),p("span",ee,"Select item..."))]),_:2},1032,["modelValue","onUpdate:modelValue","options","onChange"])]),e("td",te,[o(n,{modelValue:l.description,"onUpdate:modelValue":t=>l.description=t,placeholder:"Description",class:"w-full",disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),e("td",le,[o(n,{modelValue:l.uom,"onUpdate:modelValue":t=>l.uom=t,placeholder:"Unit",class:"w-full",disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),e("td",se,[o(r,{type:"number",modelValue:l.unitPrice,"onUpdate:modelValue":t=>l.unitPrice=t,placeholder:"0.00",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),e("td",oe,[o(r,{type:"number",modelValue:l.budgetQty,"onUpdate:modelValue":t=>l.budgetQty=t,placeholder:"0",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),e("td",ae,[o(r,{type:"number",modelValue:l.orderedQty,"onUpdate:modelValue":t=>l.orderedQty=t,placeholder:"0",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),e("td",de,[o(r,{type:"number",modelValue:l.newOrder,"onUpdate:modelValue":t=>l.newOrder=t,placeholder:"0",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),e("td",ne,[o(r,{type:"number",modelValue:l.exceededQty,"onUpdate:modelValue":t=>l.exceededQty=t,placeholder:"0",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),e("td",re,[o(r,{type:"number",modelValue:l.exceededPct,"onUpdate:modelValue":t=>l.exceededPct=t,placeholder:"0%",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),e("td",ie,[o(r,{type:"number",modelValue:l.estimatedExceed,"onUpdate:modelValue":t=>l.estimatedExceed=t,placeholder:"0.00",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),e("td",ue,[o(n,{modelValue:l.remark,"onUpdate:modelValue":t=>l.remark=t,placeholder:"Remark",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),e("td",ce,[o(u,{icon:"pi pi-trash",severity:"danger",text:"",onClick:t=>a.items.splice(d,1)},null,8,["onClick"])])]))),128))])])]),e("div",me,"Total Variance Amount: "+f(a.totalVarianceAmount.toFixed(2)),1)]),o(b,{discussions:a.discussionData,editMode:!0},null,8,["discussions"])])}const Ue=I($,[["render",pe]]);export{Ue as default};
